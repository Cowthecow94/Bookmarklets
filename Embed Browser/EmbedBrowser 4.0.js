javascript:void function(){const t=(t,e=document)=>e.querySelector(t),e=(t,e=document)=>e.querySelectorAll(t),i=(t,e)=>{for(const i in e)t.style[i]=e[i]},s={AllOrigins:"https://api.allorigins.win/raw?url={URL}",CodeTabs:"https://api.codetabs.com/v1/proxy?quest={URL}",ThingProxy:"https://thingproxy.freeboard.io/fetch/{URL}",CorsSH:"https://cors.sh/{URL}"};if(window.bkmrkltLoaded)return window.createBkmrkltWindow();window.bkmrkltLoaded=!0;const n=document.createElement("style");n.textContent=".bkmrklt-container{transition:width .2s,height .2s,top .2s,left .2s,opacity .2s;position:fixed;top:50px;left:50px;width:640px;height:480px;min-width:320px;min-height:200px;background-color:#fff;border:1px solid #ccc;border-radius:8px;box-shadow:0 5px 20px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif}.bkmrklt-header{height:30px;background-color:#f0f0f0;color:#333;cursor:move;display:flex;align-items-center;justify-content:space-between;padding:0 5px 0 10px;user-select:none;border-bottom:1px solid #dbdbdb;flex-shrink:0}.bkmrklt-header-left{display:flex;align-items:center;gap:2px;flex-shrink:0}.bkmrklt-header-center{flex-grow:1;text-align:center;overflow:hidden;padding:0 5px}.bkmrklt-title{font-size:13px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.bkmrklt-header-right{display:flex;align-items:center;gap:2px;flex-shrink:0}.bkmrklt-controls{display:flex;align-items:center;margin-left:5px}.bkmrklt-controls button{border-radius:50%;width:14px;height:14px;cursor:pointer;padding:0;opacity:.9;transition:opacity .2s;margin-left:6px;border-width:1px;border-style:solid}.bkmrklt-nav-btn{background:none;border:none;font-size:18px;color:#555;cursor:pointer;opacity:.6;transition:all .2s;padding:0;line-height:1;font-weight:700;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:4px}.bkmrklt-nav-btn:hover,.bkmrklt-controls button:hover{opacity:1}.bkmrklt-nav-btn:hover{background-color:#e0e0e0}.bkmrklt-close-btn{background:#ff5f57;border-color:#e0443e}.bkmrklt-max-btn{background:#27c93f;border-color:#1aab29}.bkmrklt-min-btn{background:#ffbd2e;border-color:#dea123}.bkmrklt-url-bar{padding:5px;background:#f0f0f0;border-bottom:1px solid #dbdbdb;display:flex;flex-shrink:0}.bkmrklt-url-input{width:100%;border:1px solid #ccc;border-radius:4px;padding:4px 8px;font-size:13px;outline:none}.bkmrklt-url-input:focus{border-color:#66afe9;box-shadow:0 0 5px rgba(102,175,233,.6)}.bkmrklt-iframe{flex-grow:1;border:none;width:100%;height:100%;background:#fff}.bkmrklt-resize-handle{position:absolute;bottom:0;right:0;width:15px;height:15px;cursor:nwse-resize;background:repeating-linear-gradient(135deg,#ccc,#ccc 1px,transparent 1px,transparent 4px);opacity:.5}.bkmrklt-minimized .bkmrklt-iframe,.bkmrklt-minimized .bkmrklt-url-bar,.bkmrklt-minimized .bkmrklt-settings{display:none}.bkmrklt-minimized{height:30px!important;min-height:30px!important}.bkmrklt-maximized{top:0!important;left:0!important;width:100%!important;height:100%!important;border-radius:0}.bkmrklt-nav-btn.active{color:#007bff;font-weight:700;text-shadow:0 0 1px #007bff}.bkmrklt-nav-btn[disabled]{opacity:.2;cursor:not-allowed}.bkmrklt-unfocused{box-shadow:0 2px 10px rgba(0,0,0,.2);border-color:#e8e8e8}.bkmrklt-unfocused .bkmrklt-controls button{background:#ddd!important;border-color:#ccc!important;opacity:.6}.bkmrklt-pinned{border:1px solid #007bff!important;box-shadow:0 0 15px rgba(0,123,255,.5)!important}.bkmrklt-loader{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,.8);display:flex;align-items:center;justify-content:center;z-index:10}.bkmrklt-spinner{border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;width:40px;height:40px;animation:bkmrklt-spin 1s linear infinite}@keyframes bkmrklt-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.bkmrklt-settings{padding:10px;background:#f9f9f9;border-bottom:1px solid #dbdbdb;font-size:12px;display:flex;flex-direction:column;gap:8px}.bkmrklt-settings label{display:flex;align-items:center;gap:5px}.bkmrklt-settings select,.bkmrklt-settings input{font-size:12px;padding:2px 4px;border:1px solid #ccc;border-radius:3px;flex-grow:1}.bkmrklt-dragover{box-shadow:0 0 0 3px #007bff inset!important}",document.head.appendChild(n);let o=localStorage.getItem("bkmrklt-proxyUrl");Object.values(s).includes(o)||(o=s.AllOrigins,localStorage.setItem("bkmrklt-proxyUrl",o)),window.bkmrkltGlobals={counter:0,zIndex:2147483e3,proxyUrl:o};class r{constructor(t={}){this.id="bkmrklt-"+window.bkmrkltGlobals.counter++;const e=t.history||[t.url||"https://www.google.com/webhp?igu=1"],s=void 0!==t.historyIndex?t.historyIndex:e.length-1;this.state={url:e[s],top:"50px",left:"50px",width:"640px",height:"480px",useProxy:!0,isMinimized:!1,isMaximized:!1,isPinned:!1,settingsOpen:!1,opacity:1,lastPosition:{},...t,history:e,historyIndex:s},this._createDOMElements(),this._attachEventListeners(),this._applyState(),this.loadUrl(this.state.url,this.state.useProxy,!0),this._bringToFront(),this._saveState()}_createDOMElements(){const e=document.createElement("div");e.className="bkmrklt-container",e.id=this.id,e.innerHTML='<div class="bkmrklt-header"><div class="bkmrklt-header-left"><button class="bkmrklt-nav-btn back-btn" title="Back">&lt;</button><button class="bkmrklt-nav-btn fwd-btn" title="Forward">&gt;</button><button class="bkmrklt-nav-btn reload-btn" title="Reload">&#8635;</button><button class="bkmrklt-nav-btn proxy-btn" title="Toggle Proxy">&#128737;&#xFE0F;</button><button class="bkmrklt-nav-btn pin-btn" title="Pin Window">&#128204;</button><button class="bkmrklt-nav-btn settings-btn" title="Settings">&#9881;&#xFE0F;</button><button class="bkmrklt-nav-btn new-window-btn" title="New Window">+</button></div><div class="bkmrklt-header-center"><span class="bkmrklt-title"></span></div><div class="bkmrklt-header-right"><div class="bkmrklt-controls"><button class="bkmrklt-min-btn" title="Minimize"></button><button class="bkmrklt-max-btn" title="Maximize"></button><button class="bkmrklt-close-btn" title="Close"></button></div></div></div><div class="bkmrklt-settings" style="display:none"><label>Opacity: <input class="opacity-slider" type="range" min="0.2" max="1" step="0.1" value="1"></label><label>Proxy: <select class="proxy-select"></select></label><label class="custom-proxy-label" style="display:none">Custom: <input class="custom-proxy-input" type="text" placeholder="https://myproxy?url={URL}"></label></div><div class="bkmrklt-url-bar"><input class="bkmrklt-url-input" type="text" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false"></div><div class="bkmrklt-loader" style="display: none;"><div class="bkmrklt-spinner"></div></div><iframe class="bkmrklt-iframe" sandbox="allow-forms allow-modals allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation"></iframe><div class="bkmrklt-resize-handle"></div>',document.body.appendChild(e),this.container=e,this.header=t(".bkmrklt-header",e),this.titleSpan=t(".bkmrklt-title",e),this.urlInput=t(".bkmrklt-url-input",e),this.iframe=t(".bkmrklt-iframe",e),this.resizeHandle=t(".bkmrklt-resize-handle",e),this.loader=t(".bkmrklt-loader",e),this.settingsPanel=t(".bkmrklt-settings",e),this.opacitySlider=t(".opacity-slider",e),this.proxySelect=t(".proxy-select",e),this.customProxyLabel=t(".custom-proxy-label",e),this.customProxyInput=t(".custom-proxy-input",e);const i=this.proxySelect;for(const t in s)i.add(new Option(t,s[t]));i.add(new Option("Custom","custom"))}_attachEventListeners(){var e,i,s;this.header.onmousedown=this._dragStart.bind(this),this.resizeHandle.onmousedown=this._resizeStart.bind(this),e=this.container,i=["mousedown","touchstart"],s=this._bringToFront.bind(this),i.forEach((t=>e.addEventListener(t,s))),t(".bkmrklt-close-btn",this.container).onclick=this._close.bind(this),t(".bkmrklt-min-btn",this.container).onclick=this._toggleMinimize.bind(this),t(".bkmrklt-max-btn",this.container).onclick=this._toggleMaximize.bind(this),t(".proxy-btn",this.container).onclick=this._toggleProxy.bind(this),t(".pin-btn",this.container).onclick=this._togglePin.bind(this),t(".settings-btn",this.container).onclick=this._toggleSettings.bind(this),t(".new-window-btn",this.container).onclick=()=>window.createBkmrkltWindow(),t(".reload-btn",this.container).onclick=()=>this.loadUrl(this.state.url,this.state.useProxy,!0),this.urlInput.onkeydown=(t=>{if("Enter"===t.key){t.preventDefault();let e=this.urlInput.value.trim();e&&e!==this.state.url&&(e.startsWith("http")||e.startsWith("file")||(e="https://"+e),this.loadUrl(e,this.state.useProxy))}}),this.iframe.onload=this._onFrameLoad.bind(this),this.opacitySlider.oninput=(t=>{this.state.opacity=t.target.value,this.container.style.opacity=this.state.opacity,this._saveState()}),this.proxySelect.onchange=this._onProxyChange.bind(this),this.customProxyInput.onchange=this._onProxyChange.bind(this),this.container.ondragover=(t=>{t.preventDefault(),this.container.classList.add("bkmrklt-dragover")}),this.container.ondragleave=()=>this.container.classList.remove("bkmrklt-dragover"),this.container.ondrop=(t=>{t.preventDefault(),this.container.classList.remove("bkmrklt-dragover");const e=t.dataTransfer.getData("text/uri-list")||t.dataTransfer.getData("text");e&&this.loadUrl(e,this.state.useProxy)}),t(".back-btn",this.container).onclick=()=>{this.state.historyIndex>0&&(this.state.historyIndex--,this.loadUrl(this.state.history[this.state.historyIndex],this.state.useProxy,!0))},t(".fwd-btn",this.container).onclick=()=>{this.state.historyIndex<this.state.history.length-1&&(this.state.historyIndex++,this.loadUrl(this.state.history[this.state.historyIndex],this.state.useProxy,!0))}}_applyState(){i(this.container,{top:this.state.top,left:this.state.left,width:this.state.width,height:this.state.height,opacity:this.state.opacity}),this.state.isMaximized&&this.container.classList.add("bkmrklt-maximized"),this.state.isMinimized&&this.container.classList.add("bkmrklt-minimized"),this.state.isPinned&&this.container.classList.add("bkmrklt-pinned"),this.settingsPanel.style.display=this.state.settingsOpen?"flex":"none",this.opacitySlider.value=this.state.opacity;let t=!1;for(let e=0;e<this.proxySelect.options.length;e++)if(this.proxySelect.options[e].value===window.bkmrkltGlobals.proxyUrl){this.proxySelect.selectedIndex=e,t=!0;break}t||(this.proxySelect.value="custom",this.customProxyInput.value=window.bkmrkltGlobals.proxyUrl),this.customProxyLabel.style.display="custom"===this.proxySelect.value?"flex":"none",this._updateUI()}_saveState(){this.state.isMaximized||this.state.isMinimized||(this.state.top=this.container.style.top,this.state.left=this.container.style.left,this.state.width=this.container.style.width,this.state.height=this.container.style.height),sessionStorage.setItem(this.id,JSON.stringify(this.state))}_updateUI(){t(".proxy-btn",this.container).classList.toggle("active",this.state.useProxy),t(".pin-btn",this.container).classList.toggle("active",this.state.isPinned),t(".settings-btn",this.container).classList.toggle("active",this.state.settingsOpen);const e=this.titleSpan.textContent.replace(" (Proxy)","").replace("Load Failed","");this.titleSpan.textContent=e+(this.state.useProxy?" (Proxy)":""),t(".back-btn",this.container).disabled=this.state.historyIndex<=0,t(".fwd-btn",this.container).disabled=this.state.historyIndex>=this.state.history.length-1}_onProxyChange(){const t=this.proxySelect.value;"custom"===t?(this.customProxyLabel.style.display="flex",window.bkmrkltGlobals.proxyUrl=this.customProxyInput.value):(this.customProxyLabel.style.display="none",window.bkmrkltGlobals.proxyUrl=t),localStorage.setItem("bkmrklt-proxyUrl",window.bkmrkltGlobals.proxyUrl)}_onFrameLoad(){clearTimeout(this.loadTimeout),this.loader.style.display="none";try{const t=this.iframe.contentWindow.document.title;this.titleSpan.textContent=t||new URL(this.state.url).hostname}catch(t){this.titleSpan.textContent=new URL(this.state.url).hostname}this._updateUI()}_close(){this.container.parentNode.removeChild(this.container),sessionStorage.removeItem(this.id)}_bringToFront(){this.state.isPinned||(window.bkmrkltGlobals.zIndex++,this.container.style.zIndex=window.bkmrkltGlobals.zIndex,e(".bkmrklt-container").forEach((t=>{t===this.container?t.classList.remove("bkmrklt-unfocused"):t.classList.add("bkmrklt-unfocused")})),this._saveState())}_dragStart(t){t.preventDefault(),this._bringToFront(),this.state.isMaximized?(i(this.container,this.state.lastPosition),this.state.isMaximized=!1,this.container.classList.remove("bkmrklt-maximized"),this.resizeHandle.style.display="block",this.dragOffsetX=parseInt(this.state.lastPosition.width,10)*(t.clientX/window.innerWidth),this.dragOffsetY=t.clientY-this.container.offsetTop,this.container.style.left=t.clientX-this.dragOffsetX+"px",this.container.style.top=t.clientY-this.dragOffsetY+"px"):(this.dragOffsetX=t.clientX-this.container.offsetLeft,this.dragOffsetY=t.clientY-this.container.offsetTop),document.onmousemove=this._dragMove.bind(this),document.onmouseup=this._dragEnd.bind(this)}_dragMove(t){this.container.style.left=t.clientX-this.dragOffsetX+"px",this.container.style.top=t.clientY-this.dragOffsetY+"px"}_dragEnd(){document.onmousemove=null,document.onmouseup=null,this._saveState()}_resizeStart(t){t.preventDefault(),this._bringToFront(),this.resizeStartX=t.clientX,this.resizeStartY=t.clientY,this.startWidth=parseInt(document.defaultView.getComputedStyle(this.container).width,10),this.startHeight=parseInt(document.defaultView.getComputedStyle(this.container).height,10),document.onmousemove=this._resizeMove.bind(this),document.onmouseup=this._resizeEnd.bind(this)}_resizeMove(t){this.container.style.width=this.startWidth+t.clientX-this.resizeStartX+"px",this.container.style.height=this.startHeight+t.clientY-this.resizeStartY+"px"}_resizeEnd(){document.onmousemove=null,document.onmouseup=null,this._saveState()}_toggleMinimize(){this.state.isMaximized=!1,this.container.classList.remove("bkmrklt-maximized"),this.state.isMinimized=!this.state.isMinimized,this.container.classList.toggle("bkmrklt-minimized",this.state.isMinimized),t(".bkmrklt-max-btn",this.container).style.display=this.state.isMinimized?"none":"block",this.resizeHandle.style.display=this.state.isMinimized?"none":"block",this._saveState()}_toggleMaximize(){this.state.isMinimized=!1,this.container.classList.remove("bkmrklt-minimized"),this.state.isMaximized?Object.assign(this.container.style,this.state.lastPosition):this.state.lastPosition={top:this.container.style.top,left:this.container.style.left,width:this.container.style.width,height:this.container.style.height},this.state.isMaximized=!this.state.isMaximized,this.container.classList.toggle("bkmrklt-maximized",this.state.isMaximized),this.resizeHandle.style.display=this.state.isMaximized?"none":"block",this._saveState()}_toggleProxy(){this.state.useProxy=!this.state.useProxy,this.loadUrl(this.state.url,this.state.useProxy,!0),this._updateUI(),this._saveState()}_togglePin(){this.state.isPinned=!this.state.isPinned,this.container.classList.toggle("bkmrklt-pinned",this.state.isPinned),this.state.isPinned?(window.bkmrkltGlobals.zIndex+=1e4,this.container.style.zIndex=window.bkmrkltGlobals.zIndex):this._bringToFront(),this._updateUI(),this._saveState()}_toggleSettings(){this.state.settingsOpen=!this.state.settingsOpen,this.settingsPanel.style.display=this.state.settingsOpen?"flex":"none",this._updateUI(),this._saveState()}loadUrl(t,e,s=!1){if(this.state.url=t,this.urlInput.value=t,this.titleSpan.textContent="Loading...",this.loader.style.display="flex",clearTimeout(this.loadTimeout),s||(this.state.historyIndex<this.state.history.length-1&&(this.state.history=this.state.history.slice(0,this.state.historyIndex+1)),this.state.history.push(t),this.state.historyIndex++),this._updateUI(),this._saveState(),e){let e;const s=window.bkmrkltGlobals.proxyUrl;e=s.includes("{URL}")?s.replace("{URL}",encodeURIComponent(t)):s+encodeURIComponent(t),fetch(e).then((t=>{if(!t.ok)throw new Error(`Proxy error: ${t.status} ${t.statusText}`);return t.text()})).then((e=>{const s=(new DOMParser).parseFromString(e,"text/html");let n=s.querySelector("base");n||(n=s.createElement("base"),s.head.insertBefore(n,s.head.firstChild)),n.href=t,this.iframe.srcdoc=s.documentElement.outerHTML})).catch((e=>{console.error("Bookmarklet proxy error:",e),this.loader.style.display="none",this.iframe.srcdoc=`<body style="font-family:sans-serif;padding:20px;color:#333;"><h2>Failed to load via proxy</h2><p><strong>URL:</strong> ${t}</p><p><strong>Error:</strong> ${e.message}</p><p>The proxy service may be down, or the target site is blocking it. Try a different proxy in the settings (⚙️).</p></body>`}))}else this.iframe.src=t,this.loadTimeout=setTimeout((()=>{this.titleSpan.textContent="Load Failed",this.loader.style.display="none",this.iframe.srcdoc=`<body style="font-family:sans-serif;padding:20px;color:#333;text-align:center;"><h2>Direct Load Failed</h2><p>The site at <strong>${t}</strong> likely prevents embedding.</p><p>Please <strong>enable the proxy</strong> (🛡️) and try again.</p></body>`}),8e3)}}window.createBkmrkltWindow=(t={})=>{const e=window.bkmrkltGlobals.counter%10*20,i={...{top:`${50+e}px`,left:`${50+e}px`},...t};return new r(i)};const l=[];for(let t=0;t<sessionStorage.length;t++){const i=sessionStorage.key(t);i.startsWith("bkmrklt-")&&l.push(i)}l.sort().forEach((t=>{try{const i=JSON.parse(sessionStorage.getItem(t));createBkmrkltWindow(i)}catch(t){console.error("Failed to restore bookmarklet window:",t)}})),0===e(".bkmrklt-container").length&&createBkmrkltWindow()}()
